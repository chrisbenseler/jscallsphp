<?php
// Set username and password
$username = 'chrisloki';
$password = 'magician';
// The message you want to send
$message = 'is twittering from php using curl';
// The twitter API address
$url = 'http://twitter.com/statuses/user_timeline.json';
// Alternative JSON version
// $url = 'http://twitter.com/statuses/update.json';
// Set up and execute the curl process
$curl_handle = curl_init();
curl_setopt($curl_handle, CURLOPT_URL, "$url");
curl_setopt($curl_handle, CURLOPT_CONNECTTIMEOUT, 2);
curl_setopt($curl_handle, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($curl_handle, CURLOPT_POST, 1);
curl_setopt($curl_handle, CURLOPT_USERPWD, $username . ":" . $password);
curl_setopt($curl_handle, CURLOPT_HTTPHEADER, array('Expect:'));
curl_setopt($curl_handle, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1);
$buffer = curl_exec($curl_handle);
echo curl_error($curl_handle);
$resultArray = curl_getinfo($curl_handle);
curl_close($curl_handle);
// check for success or failure
if (empty($buffer)) {
    echo 'message';
} else {
    echo $buffer;
}

if($resultArray['http_code'] == "200"){
        echo "<br />OK! posted to http://twitter.com/".$username."/<br />";
    } else {
        echo "eek! yegads! error";
    }

?>